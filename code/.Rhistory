knitr::opts_chunk$set(echo = TRUE)
library(xlsx)
library(dplyr)#filter
importData=read.csv("C:\\Users\\yinan\\Desktop\\rent21\\modeling\\pop-inc-rent-rc-if-allyear-cleaner-correct.CSV",stringsAsFactors=F, na.strings=c(NA,"NA"," NA"))
data <- importData[complete.cases(importData[c("MedianRent","MedianHouseholdIncome","TotalPopulation")]),]
data$Geography<-as.factor(data$Geography)
data$MedianRent<-as.numeric(data$MedianRent)
data$MedianHouseholdIncome<-as.numeric(data$MedianHouseholdIncome)
data$TotalPopulation<-as.numeric(data$TotalPopulation)
data$InflationRates<-as.numeric(data$InflationRates)
data$Year<-as.factor(data$Year)
data$RentControl<-as.factor(data$RentControl)
data_city = filter(data, Geography !=c('California'))
data_city = filter(data_city, !grepl('.*County', Geography))
hist(data_city$MedianRent,50,main="Histogram of Median Rent", xlab="Median Rent")
hist(data_city$MedianHouseholdIncome,50,main="Histogram of Median Household Income", xlab="Income")
#hist(data_city$TotalPopulation,50,main="Histogram of Total Population", xlab="Population")
label1<-paste(c("1: Rent Control&Just Cause","2: Weakened Rent Control&Just Cause","3: Rent Control/Just Cause","4. No Rent Control"),round(100*table(data_city$RentControl)/1369),"%",sep=" ")
pie(table(data_city$RentControl),label=label1,main="Pie Chart of Rent Control")
pairs(data_city[2:7],)
cor(data_city[2:5],)
pairs(data_city[2:7],)
data_city2 = filter(data_city, Geography !=c('Alameda city'))
model<-lm(MedianRent~MedianHouseholdIncome +InflationRates +Year+ RentControl,data=data_city)
summary(model)
modelrate<-lm(MedianRentIncreasingRate~MedianHouseholdIncomeIncreasingRate +InflationRates +Year+ RentControl,data=data_city)
summary(modelrate)
